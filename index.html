<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daewoong S&T - Steel Stock Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f1f5f9; }
        .sidebar-bg { background: linear-gradient(180deg, #1e293b 0%, #0f172a 100%); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // ì•„ì´ì½˜ ëŒ€ì‹  ì´ëª¨ì§€ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¶©ëŒ ë°©ì§€
        const Icon = ({ name }) => {
            const icons = {
                'dashboard': 'ğŸ“Š',
                'list': 'ğŸ“¦',
                'upload': 'ğŸ“¤',
                'search': 'ğŸ”',
                'menu': 'ğŸ”'
            };
            return <span className="text-lg mr-2">{icons[name] || ''}</span>;
        };

        // ì´ˆê¸° ìƒ˜í”Œ ë°ì´í„°
        const INITIAL_DATA = [
            { id: 1, client: 'ì‚¼ì„±ì „ì', type: 'ì›ì½”ì¼', spec: 'GI', t: 1.2, w: 1219, l: 0, weight: 15000, location: 'A-1' },
            { id: 2, client: 'LGì „ì', type: 'ìŠ¤ì¼ˆí”„', spec: 'EGI', t: 0.8, w: 500, l: 0, weight: 5000, location: 'B-2' },
            { id: 3, client: 'ì‚¼ì„±ì „ì', type: 'ì‹œíŠ¸', spec: 'HGI', t: 2.0, w: 1000, l: 2000, weight: 2000, location: 'C-1' },
        ];

        const App = () => {
            const [inventory, setInventory] = useState(INITIAL_DATA);
            const [view, setView] = useState('dashboard'); 
            const [selectedClient, setSelectedClient] = useState('ALL');
            const [searchTerm, setSearchTerm] = useState('');

            const clients = useMemo(() => ['ALL', ...new Set(inventory.map(item => item.client))], [inventory]);

            const filteredData = useMemo(() => {
                return inventory.filter(item => {
                    const matchClient = selectedClient === 'ALL' || item.client === selectedClient;
                    const matchSearch = item.spec.toLowerCase().includes(searchTerm.toLowerCase()) || 
                                      item.type.includes(searchTerm);
                    return matchClient && matchSearch;
                });
            }, [inventory, selectedClient, searchTerm]);

            const stats = useMemo(() => {
                const totalWeight = filteredData.reduce((acc, cur) => acc + cur.weight, 0);
                const byType = { 'ì›ì½”ì¼': 0, 'ìŠ¤ì¼ˆí”„': 0, 'ì‹œíŠ¸': 0, 'ë¯¸ë¶„ë¥˜': 0 };
                filteredData.forEach(item => {
                    const t = byType[item.type] !== undefined ? item.type : 'ë¯¸ë¶„ë¥˜';
                    byType[t] += item.weight;
                });
                return { totalWeight, byType };
            }, [filteredData]);

            // ì—‘ì…€ ì—…ë¡œë“œ í•¸ë“¤ëŸ¬ (ì•ˆì •ì„± ê°•í™”)
            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (evt) => {
                    try {
                        const data = evt.target.result;
                        const wb = XLSX.read(data, { type: 'array' });
                        const wsname = wb.SheetNames[0];
                        const ws = wb.Sheets[wsname];
                        const jsonData = XLSX.utils.sheet_to_json(ws);

                        const processedData = jsonData.map((row, idx) => {
                            // ì—‘ì…€ ì»¬ëŸ¼ëª… ë§¤ì¹­ (ëŒ€ì†Œë¬¸ì ìœ ì—°í•˜ê²Œ ëŒ€ì‘)
                            const getVal = (keys) => {
                                for (let k of keys) if (row[k] !== undefined) return row[k];
                                return null;
                            };

                            const w = Number(getVal(['Width', 'W', 'width', 'w']) || 0);
                            const l = Number(getVal(['Length', 'L', 'length', 'l']) || 0);
                            const t = Number(getVal(['Thickness', 'T', 'thickness', 't']) || 0);
                            const weight = Number(getVal(['Weight', 'weight', 'ì¤‘ëŸ‰']) || 0);
                            const client = getVal(['Client', 'Vendor', 'ë§¤ì…ì²˜', 'client']) || 'ë¯¸ì§€ì •';
                            const spec = getVal(['Spec', 'Specification', 'ê°•ì¢…', 'spec']) || 'No Spec';
                            const location = getVal(['Location', 'ìœ„ì¹˜', 'location']) || 'ì…ê³ ëŒ€ê¸°';

                            let type = 'ë¯¸ë¶„ë¥˜';
                            if (l > 0) type = 'ì‹œíŠ¸';
                            else if (w >= 600) type = 'ì›ì½”ì¼'; // ê¸°ì¤€: í­ 600mm ì´ìƒ
                            else type = 'ìŠ¤ì¼ˆí”„';

                            return {
                                id: Date.now() + idx,
                                client, type, spec, t, w, l, weight, location
                            };
                        });

                        setInventory(prev => [...processedData, ...prev]);
                        alert(`${processedData.length}ê±´ ì—…ë¡œë“œ ì™„ë£Œ!`);
                    } catch (error) {
                        console.error(error);
                        alert('ì—‘ì…€ íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    }
                };
                reader.readAsArrayBuffer(file);
            };

            return (
                <div className="flex h-screen overflow-hidden text-slate-800">
                    {/* ì‚¬ì´ë“œë°” */}
                    <aside className="w-64 sidebar-bg text-white flex-shrink-0 flex flex-col shadow-xl z-10">
                        <div className="p-6">
                            <h1 className="text-2xl font-black tracking-tighter italic">DAEWOONG S&T</h1>
                            <p className="text-xs text-slate-400 mt-1 font-bold">Steel Management System</p>
                        </div>
                        <nav className="flex-1 px-4 space-y-2">
                            <button onClick={() => setView('dashboard')} className={`w-full flex items-center px-4 py-3 rounded-xl transition-all font-bold ${view === 'dashboard' ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-400 hover:bg-slate-800'}`}>
                                <Icon name="dashboard" /> ëŒ€ì‹œë³´ë“œ
                            </button>
                            <button onClick={() => setView('list')} className={`w-full flex items-center px-4 py-3 rounded-xl transition-all font-bold ${view === 'list' ? 'bg-blue-600 text-white shadow-lg' : 'text-slate-400 hover:bg-slate-800'}`}>
                                <Icon name="list" /> ì¬ê³  ëª©ë¡
                            </button>
                        </nav>
                        <div className="p-6">
                            <label className="flex items-center justify-center w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl cursor-pointer text-sm font-bold transition-colors shadow-inner">
                                <Icon name="upload" /> ì—‘ì…€ ì—…ë¡œë“œ
                                <input type="file" className="hidden" accept=".xlsx, .xls" onChange={handleFileUpload} />
                            </label>
                        </div>
                    </aside>

                    {/* ë©”ì¸ ì»¨í…ì¸  */}
                    <main className="flex-1 flex flex-col bg-slate-100 overflow-hidden relative">
                        {/* í—¤ë” */}
                        <header className="bg-white/80 backdrop-blur border-b px-8 py-4 flex justify-between items-center z-10 sticky top-0">
                            <h2 className="text-xl font-black text-slate-800">
                                {view === 'dashboard' ? 'í†µê³„ ëŒ€ì‹œë³´ë“œ (Dashboard)' : 'ì¬ê³  ë¦¬ìŠ¤íŠ¸ (Inventory)'}
                            </h2>
                            <div className="flex items-center gap-4">
                                <select 
                                    className="bg-white border border-slate-200 rounded-lg px-4 py-2 text-sm font-bold text-slate-700 outline-none shadow-sm"
                                    value={selectedClient}
                                    onChange={(e) => setSelectedClient(e.target.value)}
                                >
                                    {clients.map(c => <option key={c} value={c}>{c === 'ALL' ? 'ì „ì²´ ì—…ì²´ (ALL)' : c}</option>)}
                                </select>
                                <div className="w-9 h-9 bg-slate-800 rounded-lg flex items-center justify-center text-white font-black shadow-lg">H</div>
                            </div>
                        </header>

                        <div className="flex-1 overflow-auto p-4 md:p-8">
                            {view === 'dashboard' ? (
                                <div className="space-y-6">
                                    {/* í†µê³„ ì¹´ë“œ */}
                                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4 md:gap-6">
                                        <div className="bg-slate-800 p-6 rounded-2xl shadow-lg text-white">
                                            <p className="text-slate-400 text-xs font-bold uppercase">Total Weight</p>
                                            <p className="text-3xl font-black mt-2">{(stats.totalWeight/1000).toFixed(1)} <span className="text-base text-slate-500">ton</span></p>
                                        </div>
                                        <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                                            <p className="text-blue-600 text-xs font-bold uppercase">Raw Coil (ì›ì½”ì¼)</p>
                                            <p className="text-3xl font-black text-slate-800 mt-2">{(stats.byType['ì›ì½”ì¼']/1000).toFixed(1)} <span className="text-base text-slate-400">ton</span></p>
                                        </div>
                                        <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                                            <p className="text-emerald-600 text-xs font-bold uppercase">Skelp (ìŠ¤ì¼ˆí”„)</p>
                                            <p className="text-3xl font-black text-slate-800 mt-2">{(stats.byType['ìŠ¤ì¼ˆí”„']/1000).toFixed(1)} <span className="text-base text-slate-400">ton</span></p>
                                        </div>
                                        <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-200">
                                            <p className="text-orange-600 text-xs font-bold uppercase">Sheet (ì‹œíŠ¸)</p>
                                            <p className="text-3xl font-black text-slate-800 mt-2">{(stats.byType['ì‹œíŠ¸']/1000).toFixed(1)} <span className="text-base text-slate-400">ton</span></p>
                                        </div>
                                    </div>
                                    
                                    {/* ì•ˆë‚´ ë©”ì‹œì§€ */}
                                    <div className="bg-white p-12 rounded-2xl border border-dashed border-slate-300 flex flex-col items-center justify-center text-slate-400">
                                        <span className="text-4xl mb-4">ğŸ“¥</span>
                                        <p className="font-bold">ì—‘ì…€ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´ í†µê³„ê°€ ìë™ ê°±ì‹ ë©ë‹ˆë‹¤.</p>
                                        <p className="text-xs mt-2">í•„ìˆ˜ ì»¬ëŸ¼: Client, Spec, T, W, L, Weight</p>
                                    </div>
                                </div>
                            ) : (
                                <div className="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden min-h-[500px] flex flex-col">
                                    <div className="p-4 border-b flex justify-between items-center bg-slate-50">
                                        <div className="relative flex items-center bg-white border rounded-lg px-3 py-2 w-64 shadow-sm">
                                            <Icon name="search" />
                                            <input 
                                                type="text" 
                                                placeholder="Spec, Type ê²€ìƒ‰..." 
                                                className="bg-transparent text-sm outline-none w-full font-bold"
                                                value={searchTerm}
                                                onChange={(e) => setSearchTerm(e.target.value)}
                                            />
                                        </div>
                                        <span className="text-xs font-bold text-slate-500 bg-slate-200 px-2 py-1 rounded">Total: {filteredData.length}</span>
                                    </div>
                                    <div className="overflow-auto flex-1">
                                        <table className="w-full text-sm text-left">
                                            <thead className="bg-slate-100 text-slate-500 uppercase text-xs font-black sticky top-0">
                                                <tr>
                                                    <th className="px-6 py-4">Client</th>
                                                    <th className="px-6 py-4 text-center">Type</th>
                                                    <th className="px-6 py-4">Spec</th>
                                                    <th className="px-6 py-4 text-center">T</th>
                                                    <th className="px-6 py-4 text-center">W</th>
                                                    <th className="px-6 py-4 text-center">L</th>
                                                    <th className="px-6 py-4 text-right">Weight (kg)</th>
                                                    <th className="px-6 py-4">Location</th>
                                                </tr>
                                            </thead>
                                            <tbody className="divide-y divide-slate-100">
                                                {filteredData.length > 0 ? filteredData.map(item => (
                                                    <tr key={item.id} className="hover:bg-blue-50/50 transition-colors">
                                                        <td className="px-6 py-4 font-bold text-slate-700">{item.client}</td>
                                                        <td className="px-6 py-4 text-center">
                                                            <span className={`px-2 py-1 rounded text-[10px] font-black uppercase
                                                                ${item.type === 'ì›ì½”ì¼' ? 'bg-blue-100 text-blue-700' : 
                                                                  item.type === 'ìŠ¤ì¼ˆí”„' ? 'bg-emerald-100 text-emerald-700' : 
                                                                  item.type === 'ì‹œíŠ¸' ? 'bg-orange-100 text-orange-700' : 'bg-gray-100 text-gray-500'}`}>
                                                                {item.type}
                                                            </span>
                                                        </td>
                                                        <td className="px-6 py-4 text-slate-600 font-medium">{item.spec}</td>
                                                        <td className="px-6 py-4 text-center font-mono">{item.t}</td>
                                                        <td className="px-6 py-4 text-center font-mono">{item.w}</td>
                                                        <td className="px-6 py-4 text-center font-mono text-slate-400">{item.l || '-'}</td>
                                                        <td className="px-6 py-4 text-right font-mono font-bold text-slate-800">{item.weight.toLocaleString()}</td>
                                                        <td className="px-6 py-4 text-xs font-bold text-slate-400">{item.location}</td>
                                                    </tr>
                                                )) : (
                                                    <tr>
                                                        <td colSpan="8" className="text-center py-20 text-slate-400 font-bold">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</td>
                                                    </tr>
                                                )}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>